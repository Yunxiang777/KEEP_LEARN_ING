ðŸ§© ä¸€ã€å­æŸ¥è©¢ï¼ˆSubqueryï¼‰

å­æŸ¥è©¢å°±æ˜¯ã€ŒæŸ¥è©¢ä¸­çš„æŸ¥è©¢ã€ï¼Œå®ƒå‡ºç¾åœ¨ SELECTã€WHERE æˆ– FROM å­å¥è£¡ï¼Œç”¨ä¾†æä¾›å¦ä¸€å€‹æŸ¥è©¢çš„çµæžœã€‚
æœ€å¸¸è¦‹çš„ç”¨é€”ï¼š

æ‰¾å‡ºã€Œç›¸å°æ–¼å¦ä¸€å€‹è³‡æ–™è¡¨ã€çš„è³‡æ–™ã€‚

ðŸ“˜ ç¯„ä¾‹
SELECT name, salary
FROM employees
WHERE salary > (
  SELECT AVG(salary)
  FROM employees
);


ðŸ‘‰ èªªæ˜Žï¼š
é€™è£¡çš„æ‹¬è™Ÿå…§æ˜¯å­æŸ¥è©¢ï¼Œå®ƒå…ˆç®—å‡ºå¹³å‡è–ªæ°´ï¼Œå†ç”±å¤–å±¤æŸ¥å‡ºã€Œè–ªæ°´é«˜æ–¼å¹³å‡ã€çš„å“¡å·¥ã€‚

ðŸ”¹ äºŒã€ANYï¼ˆæˆ– SOMEï¼‰

ANY è¡¨ç¤ºï¼šåªè¦å­æŸ¥è©¢çš„çµæžœä¸­ï¼Œæœ‰ä»»æ„ä¸€å€‹å€¼æ»¿è¶³æ¢ä»¶ï¼Œå°±æˆç«‹ã€‚

ðŸ“˜ ç¯„ä¾‹
SELECT name, salary
FROM employees
WHERE salary > ANY (
  SELECT salary
  FROM employees
  WHERE department_id = 10
);


ðŸ‘‰ èªªæ˜Žï¼š

å­æŸ¥è©¢æœƒå…ˆæ‰¾å‡ºéƒ¨é–€ 10 æ‰€æœ‰å“¡å·¥çš„è–ªæ°´ã€‚

å¤–å±¤æŸ¥è©¢æœƒæ‰¾å‡ºã€Œè–ªæ°´æ¯”éƒ¨é–€ 10 çš„ ä»»ä½•ä¸€å€‹äººé«˜ã€çš„å“¡å·¥ã€‚
ï¼ˆå¯¦éš›ä¸Šåªè¦æ¯”éƒ¨é–€ 10 ä¸­æœ€å°çš„è–ªæ°´é«˜ï¼Œå°±æœƒè¢«é¸ä¸­ã€‚ï¼‰

ðŸ§  å°æŠ€å·§ï¼š

> ANY â‰ˆ > MIN(...)

< ANY â‰ˆ < MAX(...)

ðŸ”¸ ä¸‰ã€ALL

ALL è¡¨ç¤ºï¼šå¿…é ˆæ»¿è¶³å­æŸ¥è©¢ä¸­ã€Œæ‰€æœ‰å€¼ã€çš„æ¢ä»¶æ‰æˆç«‹ã€‚

ðŸ“˜ ç¯„ä¾‹
SELECT name, salary
FROM employees
WHERE salary > ALL (
  SELECT salary
  FROM employees
  WHERE department_id = 10
);


ðŸ‘‰ èªªæ˜Žï¼š

å­æŸ¥è©¢æœƒå…ˆåˆ—å‡ºéƒ¨é–€ 10 çš„æ‰€æœ‰è–ªæ°´ã€‚

å¤–å±¤æŸ¥å‡ºã€Œè–ªæ°´æ¯”éƒ¨é–€ 10 æ‰€æœ‰å“¡å·¥éƒ½é«˜ã€çš„å“¡å·¥ã€‚

ðŸ§  å°æŠ€å·§ï¼š

> ALL â‰ˆ > MAX(...)

< ALL â‰ˆ < MIN(...)

ðŸ”¹ å››ã€EXISTS

EXISTS è¡¨ç¤ºï¼šå­æŸ¥è©¢æœ‰è¿”å›žè‡³å°‘ä¸€ç­†è³‡æ–™ï¼Œå°±ç‚ºçœŸ (TRUE)ã€‚
å®ƒé€šå¸¸æ­é…ç›¸é—œå­æŸ¥è©¢ï¼ˆcorrelated subqueryï¼‰ä½¿ç”¨ã€‚

ðŸ“˜ ç¯„ä¾‹
SELECT name
FROM employees e
WHERE EXISTS (
  SELECT 1
  FROM departments d
  WHERE d.manager_id = e.employee_id
);


ðŸ‘‰ èªªæ˜Žï¼š

å­æŸ¥è©¢æœƒæª¢æŸ¥è©²å“¡å·¥æ˜¯å¦æ˜¯æŸå€‹éƒ¨é–€çš„ä¸»ç®¡ã€‚

è‹¥å­˜åœ¨è‡³å°‘ä¸€ç­†ç¬¦åˆçš„ç´€éŒ„ï¼ŒEXISTS ç‚º TRUEï¼Œè©²å“¡å·¥å°±æœƒè¢«é¸å‡ºã€‚

ðŸ§  å°æŠ€å·§ï¼š

EXISTS åªé—œå¿ƒã€Œæœ‰æ²’æœ‰çµæžœã€ï¼Œä¸ç®¡å­æŸ¥è©¢ SELECT ä»€éº¼ã€‚

å¸¸ç”¨ä¾†æ¸¬è©¦ã€Œé—œè¯æ˜¯å¦å­˜åœ¨ã€ã€‚

ðŸ“Š ç¸½çµæ¯”è¼ƒè¡¨
é—œéµå­—	æ„ç¾©	ç”¨æ³•é‡é»ž	ç¯„ä¾‹èªªæ˜Ž
Subquery	æŸ¥è©¢ä¸­çš„æŸ¥è©¢	å¯æ”¾åœ¨ SELECTã€WHEREã€FROM ä¸­	æ‰¾å‡ºè–ªæ°´é«˜æ–¼å¹³å‡è€…
ANY / SOME	ä»»æ„ä¸€å€‹ç¬¦åˆå³æˆç«‹	é€šå¸¸æ­é… =, >, <	è–ªæ°´é«˜æ–¼æŸéƒ¨é–€ä»»æ„å“¡å·¥
ALL	å¿…é ˆå…¨éƒ¨ç¬¦åˆ	é€šå¸¸æ­é… =, >, <	è–ªæ°´é«˜æ–¼æŸéƒ¨é–€æ‰€æœ‰å“¡å·¥
EXISTS	æª¢æŸ¥å­æŸ¥è©¢æ˜¯å¦æœ‰çµæžœ	é€šå¸¸æ­é…é—œè¯å­æŸ¥è©¢	åˆ¤æ–·æ˜¯å¦æ˜¯ä¸»ç®¡


JOIN â†’ã€ŒæŠŠè¡¨é€£èµ·ä¾†ã€
ðŸ‘‰ é—œä¿‚åž‹ï¼ˆé—œéµå­—æ˜¯ ON æˆ– WHEREï¼‰

SET OPERATOR â†’ã€ŒæŠŠæŸ¥è©¢ç–Šèµ·ä¾†ã€
ðŸ‘‰ çµæžœåž‹ï¼ˆæ¯å€‹ SELECT éƒ½ç¨ç«‹åŸ·è¡Œï¼‰

âš™ï¸ ä¸€ã€æ¦‚å¿µæ¯”è¼ƒï¼šæ•ˆèƒ½å·®åœ¨å“ªè£¡ï¼Ÿ
é¡žåž‹	è™•ç†é‚è¼¯	æ•ˆèƒ½ç‰¹æ€§
JOIN	åŒæ™‚å¾žå¤šå¼µè¡¨å–è³‡æ–™ï¼Œä¾ç…§æ¢ä»¶æ¯”å°	âœ… é€šå¸¸æ¯”è¼ƒå¿«ï¼ˆæœ‰ç´¢å¼•çš„è©±ï¼‰
é›†åˆæŸ¥è©¢ (Set Operator)	åŸ·è¡Œå¤šå€‹ SELECTï¼Œå†åˆä½µçµæžœ	âš ï¸ é€šå¸¸æ¯”è¼ƒæ…¢ï¼ˆè¦é‡è¤‡æŽƒè¡¨ + åˆä½µ + åŽ»é‡ï¼‰
ðŸ§© äºŒã€æ¯ç¨®é›†åˆæŸ¥è©¢çš„æ•ˆèƒ½åˆ†æž
é‹ç®—å­	æ•ˆèƒ½	åŽŸå› èªªæ˜Ž
UNION ALL	âœ… æœ€å¿«	ä¸åšæŽ’åºã€ä¸åŽ»é‡ï¼Œåªå–®ç´”æŠŠçµæžœç–Šèµ·ä¾†
UNION	âš ï¸ è¼ƒæ…¢	éœ€ã€ŒæŽ’åº + åŽ»é‡ã€æ•´å€‹çµæžœé›†
INTERSECT	âš ï¸ æ…¢	éœ€ã€ŒæŽ’åº + æ¯”å°ã€å…©é‚Šçš„å®Œæ•´åˆ—
MINUS	âš ï¸ æ…¢	åŒæ¨£è¦æŽ’åºèˆ‡æ¯”å°æ•´åˆ—è³‡æ–™
ðŸ”— ä¸‰ã€JOIN çš„æ•ˆèƒ½ç‰¹æ€§
JOIN é¡žåž‹	æ•ˆèƒ½	ç‰¹é»ž
INNER JOIN	âœ… é€šå¸¸æœ€å¿«	æœ‰ç´¢å¼•æ™‚æœ€æœ‰æ•ˆçŽ‡
LEFT JOIN / RIGHT JOIN	âš ï¸ ä¸­ç­‰	å› ç‚ºè¦ä¿ç•™ä¸€é‚Šæ‰€æœ‰è³‡æ–™
FULL OUTER JOIN	âŒ è¼ƒæ…¢	ç­‰æ–¼å…©é‚Šå…¨æŽƒæå†åˆä½µ
CROSS JOIN	âŒ éžå¸¸æ…¢	ç”¢ç”Ÿç¬›å¡å…’ç©ï¼ˆä¹˜æ³•çˆ†ç‚¸ï¼‰

ðŸ“ˆ å…­ã€æ•ˆèƒ½å„ªåŒ–é‡é»ž

ç´¢å¼•ï¼ˆIndexï¼‰æ˜¯é—œéµ

JOIN æ¢ä»¶æ¬„ä½è‹¥æœ‰ç´¢å¼•ï¼Œæœƒéžå¸¸å¿«ã€‚

è‹¥æ²’æœ‰ç´¢å¼•ï¼ŒJOIN å¯èƒ½åè€Œæ¯”é›†åˆæŸ¥è©¢æ…¢ã€‚

UNION vs UNION ALL

è‹¥ä¸éœ€è¦åŽ»é‡ï¼Œç”¨ UNION ALL æ•ˆèƒ½å¥½ 5ï½ž10 å€ã€‚

é¿å… MINUS / INTERSECT

å¯æ”¹å¯«ç‚º LEFT JOIN + IS NULL æˆ– INNER JOINï¼Œæ•ˆèƒ½æ›´é«˜ã€‚

JOIN æ¯”é›†åˆæŸ¥è©¢æ›´æœ‰æ•ˆçŽ‡ï¼ˆå°¤å…¶æœ‰ç´¢å¼•æ™‚ï¼‰
ðŸ”¹ UNION ALL æ˜¯é›†åˆæŸ¥è©¢ä¸­æœ€å¿«çš„é¸é …
ðŸ”¹ MINUS / INTERSECT æœ€è€—æ•ˆèƒ½ï¼Œå»ºè­°æ”¹å¯« JOIN